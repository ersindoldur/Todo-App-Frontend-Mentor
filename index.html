<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32x32.png">
  <title>Frontend Mentor | Todo app</title>
  <style>
    :root {
      /* Light Theme Colors */
      --very-light-gray: hsl(0, 0%, 98%);
      --very-light-grayish-blue: hsl(236, 33%, 92%);
      --light-grayish-blue: hsl(233, 11%, 84%);
      --dark-grayish-blue: hsl(236, 9%, 61%);
      --very-dark-grayish-blue: hsl(235, 19%, 35%);

      /* Dark Theme Colors */
      --very-dark-blue: hsl(235, 21%, 11%);
      --very-dark-desaturated-blue: hsl(235, 24%, 19%);
      --light-grayish-blue-dark: hsl(234, 39%, 85%);
      --light-grayish-blue-hover-dark: hsl(236, 33%, 92%);
      --dark-grayish-blue-dark: hsl(234, 11%, 52%);
      --very-dark-grayish-blue-dark: hsl(233, 14%, 35%);
      --very-very-dark-grayish-blue: hsl(237, 14%, 26%);

      /* Bright Blue */
      --bright-blue: hsl(220, 98%, 61%);

      /* Gradient Colors */
      --gradient-1: hsl(192, 100%, 67%);
      --gradient-2: hsl(280, 87%, 65%);

      /* Font */
      font-family: 'Josefin Sans', sans-serif;
      font-size: 18px;
    }

    [data-theme="light"] {
      --bg-color: var(--very-light-gray);
      --todo-bg: white;
      --todo-text: var(--very-dark-grayish-blue);
      --todo-text-completed: var(--light-grayish-blue);
      --filter-text: var(--dark-grayish-blue);
      --filter-text-hover: var(--very-dark-grayish-blue);
      --border-color: var(--very-light-grayish-blue);
      --bg-image-desktop: url('images/bg-desktop-light.jpg');
      --bg-image-mobile: url('images/bg-mobile-light.jpg');
    }

    [data-theme="dark"] {
      --bg-color: var(--very-dark-blue);
      --todo-bg: var(--very-dark-desaturated-blue);
      --todo-text: var(--light-grayish-blue-dark);
      --todo-text-completed: var(--very-dark-grayish-blue-dark);
      --filter-text: var(--dark-grayish-blue-dark);
      --filter-text-hover: var(--light-grayish-blue-dark);
      --border-color: var(--very-very-dark-grayish-blue);
      --bg-image-desktop: url('images/bg-desktop-dark.jpg');
      --bg-image-mobile: url('images/bg-mobile-dark.jpg');
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background-color: var(--bg-color);
      color: var(--todo-text);
      min-height: 100vh;
      transition: background-color 0.3s ease;
      font-family: 'Josefin Sans', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .bg-image-container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 300px;
      background-image: var(--bg-image-desktop);
      background-repeat: no-repeat;
      background-size: cover;
      z-index: -1;
    }

    @media (max-width: 600px) {
      .bg-image-container {
        height: 200px;
        background-image: var(--bg-image-mobile);
      }
    }

    .container {
      width: 100%;
      max-width: 540px;
      margin: 0 auto;
      padding: 70px 20px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
    }

    h1 {
      color: white;
      font-weight: 700;
      font-size: 28px;
      letter-spacing: 12px;
    }

    .theme-toggle {
      width: 24px;
      height: 24px;
      background-color: transparent;
      border: none;
      cursor: pointer;
    }

    [data-theme="dark"] .theme-toggle {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='26' height='26'%3E%3Cpath fill='%23FFF' fill-rule='evenodd' d='M13 21a1 1 0 011 1v3a1 1 0 11-2 0v-3a1 1 0 011-1zm-5.657-2.343a1 1 0 010 1.414l-2.121 2.121a1 1 0 01-1.414-1.414l2.12-2.121a1 1 0 011.415 0zm12.728 0l2.121 2.121a1 1 0 01-1.414 1.414l-2.121-2.12a1 1 0 011.414-1.415zM13 8a5 5 0 110 10 5 5 0 010-10zm12 4a1 1 0 110 2h-3a1 1 0 110-2h3zM4 12a1 1 0 110 2H1a1 1 0 110-2h3zm18.192-8.192a1 1 0 010 1.414l-2.12 2.121a1 1 0 01-1.415-1.414l2.121-2.121a1 1 0 011.414 0zm-16.97 0l2.121 2.12A1 1 0 015.93 7.344L3.808 5.222a1 1 0 011.414-1.414zM13 0a1 1 0 011 1v3a1 1 0 11-2 0V1a1 1 0 011-1z'/%3E%3C/svg%3E");
    }

    [data-theme="light"] .theme-toggle {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='26' height='26'%3E%3Cpath fill='%23FFF' fill-rule='evenodd' d='M13 0c.81 0 1.603.074 2.373.216C10.593 1.199 7 5.43 7 10.5 7 16.299 11.701 21 17.5 21c2.996 0 5.7-1.255 7.613-3.268C23.22 22.572 18.51 26 13 26 5.82 26 0 20.18 0 13S5.82 0 13 0z'/%3E%3C/svg%3E");
    }

    .input-container {
      display: flex;
      align-items: center;
      background-color: var(--todo-bg);
      border-radius: 5px;
      padding: 18px 24px;
      margin-bottom: 24px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    }

    .circle {
      width: 24px;
      height: 24px;
      border: 1px solid var(--border-color);
      border-radius: 50%;
      margin-right: 16px;
      flex-shrink: 0;
      cursor: pointer;
    }

    .circle.completed {
      background: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
      border: none;
      position: relative;
    }

    .circle.completed::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 12px;
      height: 9px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='9'%3E%3Cpath fill='none' stroke='%23FFF' stroke-width='2' d='M1 4.304L3.696 7l6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: center;
    }

    input[type="text"] {
      width: 100%;
      background: transparent;
      border: none;
      color: var(--todo-text);
      font-size: 18px;
      outline: none;
      font-family: 'Josefin Sans', sans-serif;
    }

    input[type="text"]::placeholder {
      color: var(--filter-text);
    }

    .todo-list {
      background-color: var(--todo-bg);
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    }

    .todo-item {
      display: flex;
      align-items: center;
      padding: 18px 24px;
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
    }

    .todo-text {
      flex-grow: 1;
      transition: color 0.3s ease;
    }

    .todo-item.completed .todo-text {
      color: var(--todo-text-completed);
      text-decoration: line-through;
    }

    .delete-btn {
      opacity: 0;
      background: transparent;
      border: none;
      cursor: pointer;
      width: 18px;
      height: 18px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18'%3E%3Cpath fill='%23494C6B' fill-rule='evenodd' d='M16.97 0l.708.707L9.546 8.84l8.132 8.132-.707.707-8.132-8.132-8.132 8.132L0 16.97l8.132-8.132L0 .707.707 0 8.84 8.132 16.971 0z'/%3E%3C/svg%3E");
      transition: opacity 0.3s ease;
    }

    .todo-item:hover .delete-btn {
      opacity: 1;
    }

    .todo-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 24px;
      color: var(--filter-text);
      font-size: 14px;
    }

    .filters {
      display: flex;
      gap: 18px;
    }

    .filters button,
    .filters-mobile button {
      background: transparent;
      border: none;
      color: var(--filter-text);
      cursor: pointer;
      font-weight: 700;
      font-family: 'Josefin Sans', sans-serif;
      font-size: 14px;
    }

    .filters button:hover,
    .filters-mobile button:hover {
      color: var(--filter-text-hover);
    }

    .filters button.active,
    .filters-mobile button.active {
      color: var(--bright-blue);
    }

    .clear-completed {
      background: transparent;
      border: none;
      color: var(--filter-text);
      cursor: pointer;
      font-family: 'Josefin Sans', sans-serif;
      font-size: 14px;
    }

    .clear-completed:hover {
      color: var(--filter-text-hover);
    }

    .drag-info {
      text-align: center;
      margin-top: 50px;
      color: var(--filter-text);
      font-size: 14px;
    }

    /* Mobile styles */
    @media (max-width: 600px) {
      .container {
        padding: 50px 20px;
      }

      .filters-mobile {
        background-color: var(--todo-bg);
        border-radius: 5px;
        margin-top: 16px;
        padding: 18px 0;
        display: flex;
        justify-content: center;
        gap: 18px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }

      .todo-footer .filters {
        display: none;
      }
    }

    /* Hide mobile filters on desktop */
    @media (min-width: 601px) {
      .filters-mobile {
        display: none;
      }
    }

    /* Improve mobile UI */
    @media (max-width: 600px) {
      h1 {
        font-size: 24px;
        letter-spacing: 10px;
      }

      .input-container, .todo-item, .todo-footer {
        padding: 16px 20px;
      }

      .circle {
        width: 20px;
        height: 20px;
        margin-right: 12px;
      }

      .todo-text, input[type="text"] {
        font-size: 16px;
      }

      .filters button, .clear-completed, .todo-footer, .drag-info {
        font-size: 12px;
      }
    }

    /* Dragging styles */
    .todo-item.dragging {
      opacity: 0.5;
    }


  </style>
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="bg-image-container"></div>

  <div class="container">
    <div class="header">
      <h1>TODO</h1>
      <button type="button" class="theme-toggle" aria-label="Toggle theme"></button>
    </div>

    <div class="input-container">
      <div class="circle"></div>
      <input type="text" placeholder="Create a new todo...">
    </div>

    <div class="todo-list">
      <!-- Todo items will be added here dynamically -->
    </div>

    <div class="filters-mobile">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="active">Active</button>
      <button class="filter-btn" data-filter="completed">Completed</button>
    </div>

    <p class="drag-info">Drag and drop to reorder list</p>
  </div>

  <script>
    // DOM Elements
    const themeToggle = document.querySelector('.theme-toggle');
    const todoInput = document.querySelector('.input-container input');
    const todoList = document.querySelector('.todo-list');
    const filterBtns = document.querySelectorAll('.filter-btn');

    // State
    let todos = [
      { id: 1, text: 'Complete online JavaScript course', completed: true },
      { id: 2, text: 'Jog around the park 3x', completed: false },
      { id: 3, text: '10 minutes meditation', completed: false },
      { id: 4, text: 'Read for 1 hour', completed: false },
      { id: 5, text: 'Pick up groceries', completed: false },
      { id: 6, text: 'Complete Todo App on Frontend Mentor', completed: false }
    ];
    let nextId = 7;
    let currentFilter = 'all';

    // Check for user's preferred color scheme
    function setInitialTheme() {
      const prefersDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (prefersDarkMode) {
        document.documentElement.setAttribute('data-theme', 'dark');
      } else {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    }

    // Set initial theme based on user preference
    setInitialTheme();

    // Theme Toggle
    themeToggle.addEventListener('click', () => {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
    });

    // Add todo item
    todoInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && todoInput.value.trim() !== '') {
        const newTodo = {
          id: nextId++,
          text: todoInput.value.trim(),
          completed: false
        };

        todos.unshift(newTodo);
        todoInput.value = '';
        renderTodos();
      }
    });

    // Create todo item element
    function createTodoElement(todo) {
      const todoItem = document.createElement('div');
      todoItem.classList.add('todo-item');
      todoItem.setAttribute('data-id', todo.id);
      if (todo.completed) {
        todoItem.classList.add('completed');
      }

      const circle = document.createElement('div');
      circle.classList.add('circle');
      if (todo.completed) {
        circle.classList.add('completed');
      }

      const todoText = document.createElement('div');
      todoText.classList.add('todo-text');
      todoText.textContent = todo.text;

      const deleteBtn = document.createElement('button');
      deleteBtn.classList.add('delete-btn');
      deleteBtn.setAttribute('aria-label', 'Delete todo');

      todoItem.appendChild(circle);
      todoItem.appendChild(todoText);
      todoItem.appendChild(deleteBtn);

      // Event listeners
      circle.addEventListener('click', () => {
        todo.completed = !todo.completed;
        renderTodos();
      });

      deleteBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        todos = todos.filter(t => t.id !== todo.id);
        renderTodos();
      });

      // Make todo draggable
      todoItem.setAttribute('draggable', true);
      todoItem.addEventListener('dragstart', () => {
        todoItem.classList.add('dragging');
      });

      todoItem.addEventListener('dragend', () => {
        todoItem.classList.remove('dragging');
        updateTodosOrder();
      });

      return todoItem;
    }

    // Render todos based on filter
    function renderTodos() {
      todoList.innerHTML = '';

      // Filter todos
      const filteredTodos = todos.filter(todo => {
        if (currentFilter === 'active') return !todo.completed;
        if (currentFilter === 'completed') return todo.completed;
        return true;
      });

      // Add todos to the list
      filteredTodos.forEach(todo => {
        const todoElement = createTodoElement(todo);
        todoList.appendChild(todoElement);
      });

      // Add footer
      const footer = document.createElement('div');
      footer.classList.add('todo-footer');

      const itemsLeft = document.createElement('div');
      const activeCount = todos.filter(todo => !todo.completed).length;
      itemsLeft.textContent = `${activeCount} items left`;

      const filters = document.createElement('div');
      filters.classList.add('filters');

      const filterAll = document.createElement('button');
      filterAll.textContent = 'All';
      filterAll.classList.toggle('active', currentFilter === 'all');
      filterAll.addEventListener('click', () => setFilter('all'));

      const filterActive = document.createElement('button');
      filterActive.textContent = 'Active';
      filterActive.classList.toggle('active', currentFilter === 'active');
      filterActive.addEventListener('click', () => setFilter('active'));

      const filterCompleted = document.createElement('button');
      filterCompleted.textContent = 'Completed';
      filterCompleted.classList.toggle('active', currentFilter === 'completed');
      filterCompleted.addEventListener('click', () => setFilter('completed'));

      filters.appendChild(filterAll);
      filters.appendChild(filterActive);
      filters.appendChild(filterCompleted);

      const clearCompleted = document.createElement('button');
      clearCompleted.classList.add('clear-completed');
      clearCompleted.textContent = 'Clear Completed';
      clearCompleted.addEventListener('click', () => {
        todos = todos.filter(todo => !todo.completed);
        renderTodos();
      });

      footer.appendChild(itemsLeft);
      footer.appendChild(filters);
      footer.appendChild(clearCompleted);

      todoList.appendChild(footer);
    }

    // Set filter
    function setFilter(filter) {
      currentFilter = filter;

      // Update mobile filter buttons
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.filter === filter);
      });

      renderTodos();
    }

    // Set up mobile filter buttons
    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        setFilter(btn.dataset.filter);
      });
    });

    // Drag and drop functionality
    todoList.addEventListener('dragover', e => {
      e.preventDefault();
      const dragging = document.querySelector('.dragging');
      if (!dragging) return;

      const afterElement = getDragAfterElement(e.clientY);
      if (afterElement) {
        todoList.insertBefore(dragging, afterElement);
      } else {
        // Insert at the end but before the footer
        const footer = document.querySelector('.todo-footer');
        if (footer) {
          todoList.insertBefore(dragging, footer);
        } else {
          todoList.appendChild(dragging);
        }
      }
    });

    function getDragAfterElement(y) {
      const draggableElements = [...todoList.querySelectorAll('.todo-item:not(.dragging)')];

      return draggableElements.reduce((closest, child) => {
        const box = child.getBoundingClientRect();
        const offset = y - box.top - box.height / 2;

        if (offset < 0 && offset > closest.offset) {
          return { offset: offset, element: child };
        } else {
          return closest;
        }
      }, { offset: Number.NEGATIVE_INFINITY }).element;
    }

    function updateTodosOrder() {
      const todoElements = [...todoList.querySelectorAll('.todo-item')];
      const newTodos = [];

      todoElements.forEach(el => {
        const id = parseInt(el.dataset.id);
        const todo = todos.find(t => t.id === id);
        if (todo) {
          newTodos.push(todo);
        }
      });

      // Merge with filtered out todos (if any filter is active)
      const filteredOutTodos = todos.filter(todo => {
        if (currentFilter === 'active' && todo.completed) return true;
        if (currentFilter === 'completed' && !todo.completed) return true;
        return false;
      });

      // Combine both lists
      todos = [...newTodos, ...filteredOutTodos];
    }

    // Initial render
    renderTodos();
  </script>
</body>
</html>